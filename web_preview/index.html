<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Tech Vibe</title>
<style>
body{margin:0;padding:0;font-family:Arial;background:#f5f5f5}
.header{background:#667eea;color:white;padding:16px;text-align:center}
.main{display:flex;height:calc(100vh - 60px);margin-top:60px}
.left{width:300px;background:white;padding:16px;overflow-y:auto;border-right:1px solid #ddd}
.right{flex:1;background:white;display:flex;flex-direction:column}
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;margin:16px 0}
button{padding:8px;border:1px solid #ddd;background:white;cursor:pointer;width:100%;margin:4px 0}
input,select{width:100%;padding:8px;margin:8px 0;border:1px solid #ddd}
.btn-add{background:#667eea;color:white;border:none}
.schedule-head{padding:16px;border-bottom:1px solid #ddd}
.schedule{display:flex;flex:1}
.times{width:60px;background:#f9f9f9;border-right:1px solid #ddd;overflow-y:auto}
.time{height:60px;display:flex;align-items:center;justify-content:center;font-size:11px;border-bottom:1px solid #eee}
.grid{flex:1;position:relative;overflow-y:auto;background:linear-gradient(to bottom,#f0f0f0 1px,transparent 1px);background-size:100% 60px}
.task{position:absolute;left:4px;right:4px;background:#667eea;color:white;padding:4px;border-radius:3px;font-size:12px;display:flex;justify-content:space-between}
</style>
</head>
<body>

<div class="header"><h1 style="margin:0">Tech Vibe 日程規劃</h1></div>

<div class="main">
<div class="left">
<div>
<div style="display:flex;justify-content:space-between;margin-bottom:16px">
<button onclick="pm()" style="width:40px">←</button>
<span id="ml" style="font-weight:bold;flex:1;text-align:center">月份</span>
<button onclick="nm()" style="width:40px">→</button>
</div>
<div style="display:grid;grid-template-columns:repeat(7,1fr);gap:4px;margin-bottom:16px;font-size:12px;font-weight:bold;text-align:center">
<div>日</div><div>一</div><div>二</div><div>三</div><div>四</div><div>五</div><div>六</div>
</div>
<div id="cal" class="calendar"></div>
</div>

<hr>

<div>
<h3>新增任務</h3>
<input type="text" id="tn" placeholder="名稱">
<select id="st"></select>
<select id="dur">
<option value="0.5">0.5小時</option>
<option value="1">1小時</option>
<option value="1.5">1.5小時</option>
<option value="2" selected>2小時</option>
<option value="3">3小時</option>
<option value="4">4小時</option>
</select>
<button class="btn-add" onclick="add()">新增</button>
</div>
</div>

<div class="right">
<div class="schedule-head">
<h2 id="dl" style="margin:0">今日</h2>
<p id="hl" style="margin:8px 0 0 0;font-size:13px;color:#666">0小時</p>
</div>

<div class="schedule">
<div id="tc" class="times"></div>
<div id="gc" class="grid"></div>
</div>
</div>
</div>

<script>
let t=[],d=new Date();
function init(){
  let s=localStorage.getItem('t');
  if(s)t=JSON.parse(s);
  ren();
}
function ren(){
  renm();rcal();rtime();rsch();
}
function renm(){
  document.getElementById('ml').textContent=d.getFullYear()+'年'+(d.getMonth()+1)+'月';
}
function rcal(){
  let y=d.getFullYear(),m=d.getMonth(),f=new Date(y,m,1).getDay(),n=new Date(y,m+1,0).getDate();
  let c=document.getElementById('cal');
  c.innerHTML='';
  for(let i=0;i<f;i++){let e=document.createElement('div');c.appendChild(e);}
  for(let j=1;j<=n;j++){
    let b=document.createElement('button');
    b.textContent=j;
    let z=new Date(y,m,j).toISOString().split('T')[0];
    if(z===d.toISOString().split('T')[0])b.style.background='#667eea',b.style.color='white';
    b.onclick=()=>{d=new Date(y,m,j);ren();};
    c.appendChild(b);
  }
}
function rtime(){
  let c=document.getElementById('tc');
  c.innerHTML='';
  for(let h=0;h<24;h++){
    let e=document.createElement('div');
    e.className='time';
    e.textContent=(h<10?'0':'')+h+':00';
    c.appendChild(e);
  }
}
function rsch(){
  let z=d.toISOString().split('T')[0];
  document.getElementById('dl').textContent=d.toLocaleDateString('zh-Hant',{year:'numeric',month:'long',day:'numeric',weekday:'long'});
  let ts=t.filter(x=>x.z===z);
  let h=ts.reduce((a,x)=>a+x.dur,0);
  document.getElementById('hl').textContent=h+'小時';
  let g=document.getElementById('gc');
  g.innerHTML='';
  ts.forEach(x=>{
    let [hh,mm]=x.tm.split(':').map(Number);
    let tp=(hh*60+mm)/30*60/2;
    let ht=x.dur*30;
    let e=document.createElement('div');
    e.className='task';
    e.style.top=tp+'px';
    e.style.height=ht+'px';
    e.innerHTML='<span>'+x.n+'</span><button style="background:none;border:none;color:white;cursor:pointer" onclick="del('+x.id+')">×</button>';
    g.appendChild(e);
  });
}
function initst(){
  let s=document.getElementById('st');
  for(let h=0;h<24;h++){
    for(let m=0;m<60;m+=30){
      let tm=(h<10?'0':'')+h+':'+(m<10?'0':'')+m;
      let o=document.createElement('option');
      o.value=tm;
      o.textContent=tm;
      s.appendChild(o);
    }
  }
  s.value='09:00';
}
function add(){
  let n=document.getElementById('tn').value;
  if(!n)return alert('輸入名稱');
  let x={id:Date.now(),n:n,z:d.toISOString().split('T')[0],tm:document.getElementById('st').value,dur:parseFloat(document.getElementById('dur').value)};
  t.push(x);
  localStorage.setItem('t',JSON.stringify(t));
  document.getElementById('tn').value='';
  rsch();
}
function del(i){
  t=t.filter(x=>x.id!==i);
  localStorage.setItem('t',JSON.stringify(t));
  rsch();
}
function pm(){d.setMonth(d.getMonth()-1);ren();}
function nm(){d.setMonth(d.getMonth()+1);ren();}
window.addEventListener('load',()=>{initst();init();});
</script>

</body>
</html>
